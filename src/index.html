<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>HTML, CSS and SASS Boilerplate</title>
    <meta
      name="description"
      content="Used as a boilerplate for tasks in the 'HTML, CSS and SASS' course in boom.dev"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <div class="main">
      
    </div>
    <script>
  class Application{
  static get events() {
    return {
      READY: "ready",
    };
  }

  constructor() {

    this._loading = '<progress class="progress is-small is-primary" max="100" ></progress>'

   let main = document.querySelector(".main")
    main.innerHTML = this._loading 


    const box = document.createElement("div");
    box.classList.add("box");
    box.innerHTML = this._render({
      name: "Placeholder",
      terrain: "placeholder",
      population: 0,
    });

    document.body.querySelector(".main").appendChild(box);
    const prot = document.querySelector(".progress.is-small.is-primary");
    prot.setAttribute("_loading", "");

  }
 
  async _load(){
    let url = `https://swapi.boom.dev/api/planets`
    let allPlanets = [];
    let nextList = '';
    while(url !== null){
      await fetch(url, {
        method: 'GET',
      })
      .then(res => res.json())
      .then(data => {
         url = data.next
       // let planets = data.results
        //let box = document.querySelector(".box");
        for(let i = 0; i < data.results.length; i++){
         let planet = data.results[i]
         // box.innerHTML += this._render(planet);
         allPlanets.push(planet)
        }
      })
      
    }
     

    
      
    
  
  // let content = document.querySelector(".progress.is-small.is-primary")
   //let box2 = document.querySelector(".box").innerHTML;
  //if(box2 !== " "){
  //  content.style.display = "none"
  //}
  //console.log(allPlanets);
  
  return allPlanets
  }
 async _create(){
    let planets = await this._load();
    let box = document.querySelector(".box");
    for(let i = 0; i < planets.length; i++){
      let planet = planets[i]
       box.innerHTML += this._render(planet)
      //allPlanets.push(planet)
    }

     
   
  if(box.innerHTML !== " "){
    let content = document.querySelector(".progress.is-small.is-primary")
    content.style.display = "none"
  }
  }
  
  _startLoading(){
   
  }
  _stopLoading(){
  
  }

 

  _render({ name, terrain, population, image }) {
    return `
<article class="media">
  <div class="media-left">
    <figure class="image is-64x64">
      <img src="${image}" alt="planet">
    </figure>
  </div>
  <div class="media-content">
    <div class="content">
    <h4>${name}</h4>
      <p>
        <span class="tag">${terrain}</span> <span class="tag">${population}</span>
        <br>
      </p>
    </div>
  </div>
</article>
    `;
  }
}
window.addEventListener("DOMContentLoaded", () => {
  // This block will be executed once the page is loaded and ready
 // const _loading = '<progress class="progress is-small is-primary" max="100" ></progress>'
  const app = new Application();
  //app._load();
  app._create()
  // Used to access the app instance by the automated tests
  window.__JS_APP = app;
});


    </script>
  </body>
</html>
